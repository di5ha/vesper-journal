{
  "meta": {
    "project": "Vesper",
    "date": "2026-02-21",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "Vesper is a journaling web app that combines a simple writing shell with AI-generated insights, semantic search, mood drift visualizations, and weekly PDF reports. Users sign in with Supabase auth, create and auto-save entries, and explore analysis and trends across their writing.",
  "core_goals": [
    "Enable secure user authentication and session persistence via Supabase",
    "Provide a fast, autosaving rich journal editor with full CRUD for entries",
    "Deliver AI-generated insights per entry (mood, themes, distortions, observation)",
    "Support semantic search over entries using vector embeddings",
    "Visualize mood drift over time and let users generate weekly AI-synthesized reports with PDF export",
    "Offer smooth navigation and protected routes, with clear loading and error states"
  ],
  "features": [
    {
      "name": "User Authentication",
      "description": "Sign up and sign in with email/password via Supabase; session persistence and protected-route enforcement.",
      "user_flows": [
        "Navigate to /auth -> Fill email input field -> Fill password input field -> Click Sign in button to login -> See dashboard",
        "Navigate to /auth -> Click Sign up link to switch to signup mode -> Fill email input field -> Fill password input field -> Click Create account button to register -> See info message to check email after signup",
        "Navigate to /auth -> Fill email input field -> Fill password input field -> Click Sign in button to login -> See error message on invalid credentials",
        "Navigate to /dashboard while unauthenticated -> Be redirected to /auth -> See login form"
      ]
    },
    {
      "name": "Journal Entry Management",
      "description": "Create, edit, auto-save, search, and delete journal entries from the dashboard's sidebar and editor with visual save state.",
      "user_flows": [
        "Navigate to /dashboard -> Click New Entry button in sidebar to start writing -> Type content in the journal editor textarea -> Entry auto-saves after typing stops -> See Saved state indicator -> See new entry appear in sidebar",
        "Navigate to /dashboard -> Click an existing entry in the sidebar to load it -> Type content in the journal editor textarea -> Entry auto-saves after typing stops -> See Saved state indicator",
        "Navigate to /dashboard -> Click an existing entry in the sidebar to load it -> Click Delete entry icon in sidebar -> Confirm deletion -> See entry removed from sidebar",
        "Navigate to /dashboard -> Fill search input in sidebar -> Wait 500ms debounce -> See semantic results list -> Click a search result -> See entry load in editor",
        "Navigate to /dashboard -> Type content in the journal editor textarea -> Entry auto-saves after typing stops -> See Saving… -> See error message on save failure"
      ]
    },
    {
      "name": "AI Analysis Insight Panel",
      "description": "Right-side panel shows AI analysis for the active entry: mood score, themes, cognitive distortions, and an observation with loading and fallback states.",
      "user_flows": [
        "Navigate to /dashboard -> Click an existing entry in the sidebar to load it -> See pulsing loading skeleton in insight panel -> Poll analysis until analyzed flag is true -> See mood score, themes, and sentiment displayed in insight panel",
        "Navigate to /dashboard -> Click an existing entry in the sidebar to load it -> See pulsing loading skeleton in insight panel -> See 'Analysis unavailable' fallback when analysis fails",
        "Navigate to /dashboard -> Click an existing entry in the sidebar to load it -> See mood score displayed as colored arc -> See themes displayed as pill tags -> See cognitive distortions displayed as warning cards"
      ]
    },
    {
      "name": "Drift Timeline",
      "description": "A dedicated page that visualizes mood-score trends over time using Recharts with clickable theme filters and custom tooltips.",
      "user_flows": [
        "Navigate to /drift -> See loading skeleton -> See mood timeline chart rendered with points and area",
        "Navigate to /drift -> See all available themes as clickable pills -> Click a theme pill to filter timeline -> See filtered mood timeline chart",
        "Navigate to /drift -> See no themes available empty state when user has no analyzed entries"
      ]
    },
    {
      "name": "Weekly Reports",
      "description": "Generate AI-synthesized weekly reports from the last 7 entries, view past reports, and download report PDFs.",
      "user_flows": [
        "Navigate to /reports -> Click Generate Report button to create a new weekly report -> See new report card appear in list -> Click a report card to view details -> Click Download PDF button to save report as PDF",
        "Navigate to /reports -> See list of past reports displayed in card grid -> Click a report card to view its details",
        "Navigate to /reports -> Click Generate Report button to create a new weekly report -> See error message when report generation fails",
        "Navigate to /reports -> Click a report card -> Click Download PDF button -> See error message when PDF download fails"
      ]
    },
    {
      "name": "Navigation",
      "description": "Sidebar navigation to switch between Dashboard, Drift Timeline, and Reports, plus sign out functionality and protected-route behavior.",
      "user_flows": [
        "Navigate to /dashboard -> Click Drift nav link -> See /drift route and drift page content",
        "Navigate to /drift -> Click Reports nav link -> See /reports route and reports page content",
        "Navigate to /dashboard -> Click Sign out button -> Be redirected to /auth",
        "Navigate to /dashboard while unauthenticated -> Be redirected to /auth when trying to access a protected route"
      ]
    }
  ],
  "code_summary": {
    "version": "2",
    "type": "frontend",
    "tech_stack": [
      "javascript",
      "react",
      "tailwindcss",
      "vite",
      "supabase",
      "recharts",
      "react-router-dom"
    ],
    "routes": [
      {
        "path": "/auth",
        "file": "src/pages/Auth.jsx",
        "auth_required": false,
        "description": "Login and signup page with email/password authentication via Supabase"
      },
      {
        "path": "/dashboard",
        "file": "src/pages/Dashboard.jsx",
        "auth_required": true,
        "description": "Main three-column writing shell with sidebar, journal editor, and insight panel"
      },
      {
        "path": "/drift",
        "file": "src/pages/DriftTimeline.jsx",
        "auth_required": true,
        "description": "Mood-score drift timeline with theme filtering and charts"
      },
      {
        "path": "/reports",
        "file": "src/pages/Reports.jsx",
        "auth_required": true,
        "description": "Weekly AI-generated reports with PDF download"
      }
    ],
    "features": [
      {
        "name": "User Authentication",
        "description": "Sign up and login with email and password using Supabase Auth",
        "files": [
          "src/pages/Auth.jsx",
          "src/hooks/useAuth.jsx",
          "src/lib/supabase.js",
          "src/components/ProtectedRoute.jsx"
        ],
        "entry_route": "/auth",
        "user_interactions": [
          "Fill email input field",
          "Fill password input field",
          "Click Sign in button to login",
          "Click Sign up link to switch to signup mode",
          "Click Create account button to register",
          "See error message on invalid credentials",
          "See info message to check email after signup"
        ],
        "api_calls": [],
        "auth_required": false
      },
      {
        "name": "Journal Entry Management",
        "description": "Create, edit, auto-save, and delete journal entries in a rich editor",
        "files": [
          "src/pages/Dashboard.jsx",
          "src/components/JournalEditor.jsx",
          "src/components/Sidebar.jsx",
          "src/hooks/useAutoSave.js",
          "src/lib/api.js"
        ],
        "entry_route": "/dashboard",
        "user_interactions": [
          "Click New Entry button in sidebar to start writing",
          "Type content in the journal editor textarea",
          "Entry auto-saves after typing stops",
          "Click an existing entry in the sidebar to load it",
          "Delete an entry from the sidebar",
          "Search entries via semantic search in sidebar"
        ],
        "api_calls": [
          {
            "method": "POST",
            "endpoint": "/entries"
          },
          {
            "method": "PUT",
            "endpoint": "/entries/{id}"
          },
          {
            "method": "GET",
            "endpoint": "/entries"
          },
          {
            "method": "GET",
            "endpoint": "/entries/{id}"
          },
          {
            "method": "DELETE",
            "endpoint": "/entries/{id}"
          },
          {
            "method": "POST",
            "endpoint": "/entries/search"
          }
        ],
        "auth_required": true
      },
      {
        "name": "AI Analysis Insight Panel",
        "description": "View AI-generated analysis (mood, themes, sentiment) for the active journal entry",
        "files": [
          "src/components/InsightPanel.jsx",
          "src/hooks/useAnalysis.js",
          "src/lib/api.js"
        ],
        "entry_route": "/dashboard",
        "user_interactions": [
          "Select a journal entry to view its AI analysis",
          "See mood score, themes, and sentiment displayed in insight panel",
          "See loading state while analysis is being generated"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "/entries/{id}/analysis"
          }
        ],
        "auth_required": true
      },
      {
        "name": "Drift Timeline",
        "description": "Visualize mood-score trends over time with theme filtering using Recharts",
        "files": [
          "src/pages/DriftTimeline.jsx",
          "src/lib/api.js"
        ],
        "entry_route": "/drift",
        "user_interactions": [
          "View mood timeline chart",
          "Filter timeline by theme",
          "See all available themes"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "/drift/themes"
          },
          {
            "method": "GET",
            "endpoint": "/drift/timeline"
          }
        ],
        "auth_required": true
      },
      {
        "name": "Weekly Reports",
        "description": "Generate and view AI-synthesized weekly reports with PDF download",
        "files": [
          "src/pages/Reports.jsx",
          "src/components/ReportCard.jsx",
          "src/lib/api.js"
        ],
        "entry_route": "/reports",
        "user_interactions": [
          "Click Generate Report button to create a new weekly report",
          "View list of past reports",
          "Click a report card to view details",
          "Click Download PDF button to save report as PDF"
        ],
        "api_calls": [
          {
            "method": "POST",
            "endpoint": "/reports/generate"
          },
          {
            "method": "GET",
            "endpoint": "/reports"
          },
          {
            "method": "GET",
            "endpoint": "/reports/{id}"
          },
          {
            "method": "GET",
            "endpoint": "/reports/{id}/pdf"
          }
        ],
        "auth_required": true
      },
      {
        "name": "Navigation",
        "description": "Sidebar navigation between Dashboard, Drift Timeline, and Reports pages",
        "files": [
          "src/components/Sidebar.jsx",
          "src/App.jsx"
        ],
        "entry_route": "/dashboard",
        "user_interactions": [
          "Click Dashboard nav link",
          "Click Drift nav link",
          "Click Reports nav link",
          "Click Sign out button"
        ],
        "api_calls": [],
        "auth_required": true
      }
    ],
    "known_limitations": [
      {
        "issue": "All protected routes require Supabase authentication — no test/demo mode available",
        "location": "src/components/ProtectedRoute.jsx",
        "impact": "Testing requires valid Supabase credentials"
      },
      {
        "issue": "Auto-save has no offline/conflict resolution",
        "location": "src/hooks/useAutoSave.js",
        "impact": "Simultaneous edits in multiple tabs could cause data loss"
      }
    ]
  }
}
